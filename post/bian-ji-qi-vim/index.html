<html>
<head>
    <meta charset="utf-8"/>
<meta name="description" content=""/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>

<title>编辑器（Vim） | Cool Coding</title>

<link rel="shortcut icon" href="https://umeimmense.github.io/favicon.ico?v=1651587515143">

<link href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://umeimmense.github.io/styles/main.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.0/dist/css/bootstrap.min.css">

<script src="https://cdn.jsdelivr.net/npm/@highlightjs/cdn-assets/highlight.min.js"></script>
<script src="https://cdn.bootcss.com/highlight.js/9.15.10/languages/dockerfile.min.js"></script>
<script src="https://cdn.bootcss.com/highlight.js/9.15.10/languages/dart.min.js"></script>

<script src="https://cdn.jsdelivr.net/npm/moment@2.27.0/moment.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.0/dist/js/bootstrap.min.js"></script>
<!-- DEMO JS -->
<!--<script src="media/scripts/index.js"></script>-->



    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.css">
</head>
<body>
<div class="main gt-bg-theme-color-first">
    <nav class="navbar navbar-expand-lg">
    <div class="navbar-brand">
        <img class="user-avatar" src="/images/avatar.png" alt="头像">
        <div class="site-name gt-c-content-color-first">
            Cool Coding
        </div>
    </div>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <i class="fas fa-bars gt-c-content-color-first" style="font-size: 18px"></i>
    </button>
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <div class="navbar-nav mr-auto" style="text-align: center">
            
                <div class="nav-item">
                    
                        <a href="/" class="menu gt-a-link">
                            首页
                        </a>
                    
                </div>
            
                <div class="nav-item">
                    
                        <a href="/archives" class="menu gt-a-link">
                            归档
                        </a>
                    
                </div>
            
                <div class="nav-item">
                    
                        <a href="/tags" class="menu gt-a-link">
                            标签
                        </a>
                    
                </div>
            
                <div class="nav-item">
                    
                        <a href="/post/about" class="menu gt-a-link">
                            关于
                        </a>
                    
                </div>
            
                <div class="nav-item">
                    
                        <a href="https://umeimmense.github.io/resume/" class="menu gt-a-link" target="_blank">
                            简历
                        </a>
                    
                </div>
            
        </div>
        <div style="text-align: center">
            <form id="gridea-search-form" style="position: relative" data-update="1651587515143" action="/search/index.html">
                <input class="search-input" autocomplete="off" spellcheck="false" name="q" placeholder="搜索文章" />
                <i class="fas fa-search gt-c-content-color-first" style="position: absolute; top: 9px; left: 10px;"></i>
            </form>
        </div>
    </div>
</nav>

    <div class="post-container">
        <div class="post-detail gt-bg-theme-color-second">
            <article class="gt-post-content">
                <h2 class="post-title">
                    编辑器（Vim）
                </h2>
                <div class="post-info">
                    <time class="post-time gt-c-content-color-first">
                        · 2022-05-01 ·
                    </time>
                    
                        <a href="https://umeimmense.github.io/tag/the-missing-semester-of-your-cs-education" class="post-tags">
                            # The-Missing-Semester-of-Your-CS-Education
                        </a>
                    
                </div>
                <div class="post-content">
                    <blockquote>
<p>课程链接：<a href="https://missing-semester-cn.github.io/2020/editors/">编辑器 (Vim) · the missing semester of your cs education (missing-semester-cn.github.io)</a></p>
</blockquote>
<p>写作和写代码其实是两项非常不同的活动。当我们编程的时候，会经常在文件间进行切换、阅读、浏览和修改代码，而不是连续编写一大段的文字。因此代码编辑器和文本编辑器是很不同的两种工具（例如 微软的 Word 与 Visual Studio Code）</p>
<p>作为程序员，我们大部分时间都花在代码编辑上，所以花点时间掌握某个适合自己的编辑器是非常值得的。通常学习使用一个新的编辑器包含以下步骤：</p>
<ul>
<li>阅读教程（比如这节课以及我们为您提供的资源）</li>
<li>坚持使用它来完成你所有的编辑工作（即使一开始这会让你的工作效率降低）</li>
<li>随时查阅：如果某个操作看起来像是有更方便的实现方法，一般情况下真的会有。</li>
</ul>
<p>如果您能够遵循上述步骤，并且坚持使用新的编辑器完成您所有的文本编辑任务，那么学习一个复杂的代码编辑器的过程一般是这样的：头两个小时，您会学习到编辑器的基本操作，例如打开和编辑文件、保存与退出、浏览缓冲区。当学习时间累计达到20个小时之后，您使用新编辑器的效率应该已经和使用老编辑器一样快。在此之后，其益处开始显现：有了足够的知识和肌肉记忆后，使用新编辑器将大大节省你的时间。而现代文本编辑器都是些复杂且强大的工具，永远有新东西可学：学的越多，效率越高。</p>
<h1 id="该学哪个编辑器">该学哪个编辑器？</h1>
<p>程序员们对自己正在使用的文本编辑器通常有着 <a href="https://en.wikipedia.org/wiki/Editor_war">非常强的执念</a>。</p>
<p>现在最流行的编辑器是什么？ <a href="https://insights.stackoverflow.com/survey/2019/#development-environments-and-tools">Stack Overflow的调查</a>(这个调查可能并不如我们想象的那样客观，因为Stack Overflow 的用户并不能代表所有程序员 )显示， <a href="https://code.visualstudio.com/">Visual Studio Code</a>是目前最流行的代码编辑器。而<a href="https://www.vim.org/">Vim</a> 则是最流行的基于命令行的编辑器。</p>
<h2 id="vim">Vim</h2>
<p>这门课的所有教员都使用Vim作为编辑器。Vim有着悠久历史；它始于1976年的Vi编辑器，到现在还在 不断开发中。Vim有很多聪明的设计思想，所以很多其他工具也支持Vim模式（比如，140万人安装了 <a href="https://github.com/VSCodeVim/Vim">Vim emulation for VS code</a>）。即使你最后使用 其他编辑器，Vim也值得学习。</p>
<p>由于不可能在50分钟内教授Vim的所有功能， 我们会专注于解释Vim的设计哲学，教你基础知识， 展示一部分高级功能，然后给你掌握这个工具所需要的资源。</p>
<h1 id="vim的哲学">Vim的哲学</h1>
<p>在编程的时候，你会把大量时间花在阅读/编辑而不是在写代码上。所以， Vim 是一个 <em>多模态</em> 编辑 器： 它对于插入文字和操纵文字有不同的模式。 Vim 既是可编程的 （可以使用 Vimscript 或者像 Python 一样的其他程序语言）， Vim 的接口本身也是一个程序语言： 键入操作 （以及其助记名） 是命令， 这些命令也是可组合的。 Vim 避免了使用鼠标，因为那样太慢了； Vim 甚至避免用 上下左右键因为那样需要太多的手指移动。</p>
<p>这样的设计哲学的结果是一个能跟上你思维速度的编辑器。</p>
<h1 id="编辑模式">编辑模式</h1>
<p>Vim的设计以大多数时间都花在阅读、浏览和进行少量编辑改动为基础，因此它具有多种操作模式：</p>
<ul>
<li><em>正常模式</em>：在文件中四处移动光标进行修改</li>
<li><em>插入模式</em>：插入文本</li>
<li><em>替换模式</em>：替换文本</li>
<li><em>可视化（一般，行，块）模式</em>：选中文本块</li>
<li><em>命令模式</em>：用于执行命令</li>
</ul>
<p>在不同的操作模式下， 键盘敲击的含义也不同。比如，<code>x</code> 在插入模式会插入字母<code>x</code>，但是在正常模式 会删除当前光标所在的字母，在可视模式下则会删除选中文块。</p>
<p>在默认设置下，Vim会在左下角显示当前的模式。 Vim启动时的默认模式是正常模式。通常你会把大部分 时间花在正常模式和插入模式。</p>
<p>你可以按下 <code>&lt;ESC&gt;</code> （退出键） 从任何其他模式返回正常模式。 在正常模式，键入 <code>i</code> 进入插入 模式， <code>R</code> 进入替换模式， <code>v</code> 进入可视（一般）模式， <code>V</code> 进入可视（行）模式， <code>&lt;C-v&gt;</code> （Ctrl-V, 有时也写作 <code>^V</code>）进入可视（块）模式， <code>:</code> 进入命令模式。</p>
<p>因为你会在使用 Vim 时大量使用 <code>&lt;ESC&gt;</code> 键，所以可以考虑把大小写锁定键重定义成 <code>&lt;ESC&gt;</code> 键 （<a href="https://vim.fandom.com/wiki/Map_caps_lock_to_escape_in_macOS">MacOS 教程</a> ）。</p>
<h1 id="基本操作">基本操作</h1>
<h2 id="插入文本">插入文本</h2>
<p>在正常模式， 键入 <code>i</code> 进入插入模式。 现在 Vim 跟很多其他的编辑器一样， 直到你键入<code>&lt;ESC&gt;</code> 返回正常模式。 你只需要掌握这一点和上面介绍的所有基础知识就可以使用 Vim 来编辑文件了 （虽然如果你一直停留在插入模式内不一定高效）。</p>
<h2 id="缓存-标签页-窗口">缓存， 标签页， 窗口</h2>
<p>Vim 会维护一系列打开的文件，称为 “缓存”。 一个 Vim 会话包含一系列标签页，每个标签页包含 一系列窗口 （分隔面板）。每个窗口显示一个缓存。 跟网页浏览器等其他你熟悉的程序不一样的是， 缓存和窗口不是一一对应的关系； 窗口只是视角。 一个缓存可以在 <em>多个</em> 窗口打开，甚至在同一 个标签页内的多个窗口打开。这个功能其实很好用， 比如在查看同一个文件的不同部分的时候。</p>
<p>Vim 默认打开一个标签页，这个标签也包含一个窗口。</p>
<h2 id="命令行">命令行</h2>
<p>在正常模式下键入 <code>:</code> 进入命令行模式。 在键入 <code>:</code> 后，你的光标会立即跳到屏幕下方的命令行。 这个模式有很多功能， 包括打开， 保存， 关闭文件， 以及 <a href="https://twitter.com/iamdevloper/status/435555976687923200">退出 Vim</a>。</p>
<ul>
<li>
<p><code>:q</code> 退出 （关闭窗口）</p>
</li>
<li>
<p><code>:w</code> 保存 （写）</p>
</li>
<li>
<p><code>:wq</code> 保存然后退出</p>
</li>
<li>
<p><code>:e {文件名}</code> 打开要编辑的文件</p>
</li>
<li>
<p><code>:ls</code> 显示打开的缓存</p>
</li>
<li>
<pre><code class="language-plaintext">  :help {标题}
</code></pre>
<p>打开帮助文档</p>
<ul>
<li><code>:help :w</code> 打开 <code>:w</code> 命令的帮助文档</li>
<li><code>:help w</code> 打开 <code>w</code> 移动的帮助文档</li>
</ul>
</li>
</ul>
<h1 id="vim-的接口其实是一种编程语言">Vim 的接口其实是一种编程语言</h1>
<p>Vim 最重要的设计思想是 Vim 的界面本身是一个程序语言。 键入操作 （以及他们的助记名） 本身是命令， 这些命令可以组合使用。 这使得移动和编辑更加高效，特别是一旦形成肌肉记忆。</p>
<h2 id="移动">移动</h2>
<p>多数时候你会在正常模式下，使用移动命令在缓存中导航。在 Vim 里面移动也被称为 “名词”， 因为它们指向文字块。</p>
<ul>
<li>
<p>基本移动: <code>hjkl</code> （左， 下， 上， 右）</p>
</li>
<li>
<p>词： <code>w</code> （下一个词）， <code>b</code> （词初）， <code>e</code> （词尾）</p>
</li>
<li>
<p>行： <code>0</code> （行初）， <code>^</code> （第一个非空格字符）， <code>$</code> （行尾）</p>
</li>
<li>
<p>屏幕： <code>H</code> （屏幕首行）， <code>M</code> （屏幕中间）， <code>L</code> （屏幕底部）</p>
</li>
<li>
<p>翻页： <code>Ctrl-u</code> （上翻）， <code>Ctrl-d</code> （下翻）</p>
</li>
<li>
<p>文件： <code>gg</code> （文件头）， <code>G</code> （文件尾）</p>
</li>
<li>
<p>行数： <code>:{行数}&lt;CR&gt;</code> 或者 <code>{行数}G</code> ({行数}为行数)</p>
</li>
<li>
<p>杂项： <code>%</code> （找到配对，比如括号或者 /* */ 之类的注释对）</p>
</li>
<li>
<p>查找：</p>
<pre><code class="language-plaintext">f{字符}
</code></pre>
<p>，</p>
<pre><code class="language-plaintext">t{字符}
</code></pre>
<p>，</p>
<pre><code class="language-plaintext">F{字符}
</code></pre>
<p>，</p>
<pre><code class="language-plaintext">T{字符}
</code></pre>
<ul>
<li>查找/到 向前/向后 在本行的{字符}</li>
<li><code>,</code> / <code>;</code> 用于导航匹配</li>
</ul>
</li>
<li>
<p>搜索: <code>/{正则表达式}</code>, <code>n</code> / <code>N</code> 用于导航匹配</p>
</li>
</ul>
<h2 id="选择">选择</h2>
<p>可视化模式:</p>
<ul>
<li>可视化</li>
<li>可视化行</li>
<li>可视化块</li>
</ul>
<p>可以用移动命令来选中。</p>
<h2 id="编辑">编辑</h2>
<p>所有你需要用鼠标做的事， 你现在都可以用键盘：采用编辑命令和移动命令的组合来完成。 这就是 Vim 的界面开始看起来像一个程序语言的时候。Vim 的编辑命令也被称为 “动词”， 因为动词可以施动于名词。</p>
<ul>
<li>
<pre><code class="language-plaintext">  i
</code></pre>
<p>进入插入模式</p>
<ul>
<li>但是对于操纵/编辑文本，不单想用退格键完成</li>
</ul>
</li>
<li>
<p><code>O</code> / <code>o</code> 在之上/之下插入行</p>
</li>
<li>
<pre><code class="language-plaintext">  d{移动命令}
</code></pre>
<p>删除 {移动命令}</p>
<ul>
<li>例如， <code>dw</code> 删除词, <code>d$</code> 删除到行尾, <code>d0</code> 删除到行头。</li>
</ul>
</li>
<li>
<pre><code class="language-plaintext">  c{移动命令}
</code></pre>
<p>改变 {移动命令}</p>
<ul>
<li>例如， <code>cw</code> 改变词</li>
<li>比如 <code>d{移动命令}</code> 再 <code>i</code></li>
</ul>
</li>
<li>
<p><code>x</code> 删除字符 （等同于 <code>dl</code>）</p>
</li>
<li>
<p><code>s</code> 替换字符 （等同于 <code>xi</code>）</p>
</li>
<li>
<p>可视化模式 + 操作</p>
<ul>
<li>选中文字, <code>d</code> 删除 或者 <code>c</code> 改变</li>
</ul>
</li>
<li>
<p><code>u</code> 撤销, <code>&lt;C-r&gt;</code> 重做</p>
</li>
<li>
<p><code>y</code> 复制 / “yank” （其他一些命令比如 <code>d</code> 也会复制）</p>
</li>
<li>
<p><code>p</code> 粘贴</p>
</li>
<li>
<p>更多值得学习的: 比如 <code>~</code> 改变字符的大小写</p>
</li>
</ul>
<h2 id="计数">计数</h2>
<p>你可以用一个计数来结合“名词” 和 “动词”， 这会执行指定操作若干次。</p>
<ul>
<li><code>3w</code> 向前移动三个词</li>
<li><code>5j</code> 向下移动5行</li>
<li><code>7dw</code> 删除7个词</li>
</ul>
<h2 id="修饰语">修饰语</h2>
<p>你可以用修饰语改变 “名词” 的意义。修饰语有 <code>i</code>， 表示 “内部” 或者 “在内“， 和 <code>a</code>， 表示 ”周围“。</p>
<ul>
<li><code>ci(</code> 改变当前括号内的内容</li>
<li><code>ci[</code> 改变当前方括号内的内容</li>
<li><code>da'</code> 删除一个单引号字符串， 包括周围的单引号</li>
</ul>
<h1 id="演示">演示</h1>
<p>这里是一个有问题的 <a href="https://en.wikipedia.org/wiki/Fizz_buzz">fizz buzz</a> 实现：</p>
<pre><code>def fizz_buzz(limit):
    for i in range(limit):
        if i % 3 == 0:
            print('fizz')
        if i % 5 == 0:
            print('fizz')
        if i % 3 and i % 5:
            print(i)

def main():
    fizz_buzz(10)
</code></pre>
<p>我们会修复以下问题：</p>
<ul>
<li>主函数没有被调用</li>
<li>从 0 而不是 1 开始</li>
<li>在 15 的整数倍的时候在不用行打印 “fizz” 和 “buzz”</li>
<li>在 5 的整数倍的时候打印 “fizz”</li>
<li>采用硬编码的参数 10 而不是从命令控制行读取参数</li>
</ul>
<p>展示详情请观看课程视频。 比较上面用 Vim 的操作和你可能使用其他程序的操作。 值得一提的是 Vim 需要很少的键盘操作，允许你编辑的速度跟上你思维的速度。</p>
<h1 id="自定义-vim">自定义 Vim</h1>
<p>Vim 由一个位于 <code>~/.vimrc</code> 的文本配置文件 （包含 Vim 脚本命令）。 你可能会启用很多基本 设置。</p>
<p>我们提供一个文档详细的基本设置， 你可以用它当作你的初始设置。 我们推荐使用这个设置因为 它修复了一些 Vim 默认设置奇怪行为。 <strong>在 <a href="https://missing-semester-cn.github.io/2020/files/vimrc">这儿</a> 下载我们的设置， 然后将它保存成 <code>~/.vimrc</code>.</strong></p>
<p>Vim 能够被重度自定义， 花时间探索自定义选项是值得的。 你可以参考其他人的在 GitHub 上共享的设置文件， 比如， 你的授课人的 Vim 设置 (<a href="https://github.com/anishathalye/dotfiles/blob/master/vimrc">Anish</a>, <a href="https://github.com/jonhoo/configs/blob/master/editor/.config/nvim/init.vim">Jon</a> (uses <a href="https://neovim.io/">neovim</a>), <a href="https://github.com/JJGO/dotfiles/blob/master/vim/.vimrc">Jose</a>)。 有很多好的博客文章也聊到了这个话题。 尽量不要复制粘贴别人的整个设置文件， 而是阅读和理解它， 然后采用对你有用的部分。</p>
<h1 id="扩展-vim">扩展 Vim</h1>
<p>Vim 有很多扩展插件。 跟很多互联网上已经过时的建议相反， 你 <em>不</em> 需要在 Vim 使用一个插件 管理器（从 Vim 8.0 开始）。 你可以使用内置的插件管理系统。 只需要创建一个 <code>~/.vim/pack/vendor/start/</code> 的文件夹， 然后把插件放到这里 （比如通过 <code>git clone</code>）。</p>
<p>以下是一些我们最爱的插件：</p>
<ul>
<li><a href="https://github.com/ctrlpvim/ctrlp.vim">ctrlp.vim</a>: 模糊文件查找</li>
<li><a href="https://github.com/mileszs/ack.vim">ack.vim</a>: 代码搜索</li>
<li><a href="https://github.com/scrooloose/nerdtree">nerdtree</a>: 文件浏览器</li>
<li><a href="https://github.com/easymotion/vim-easymotion">vim-easymotion</a>: 魔术操作</li>
</ul>
<p>我们尽量避免在这里提供一份冗长的插件列表。 你可以查看讲师们的开源的配置文件 (<a href="https://github.com/anishathalye/dotfiles">Anish</a>, <a href="https://github.com/jonhoo/configs">Jon</a>, <a href="https://github.com/JJGO/dotfiles">Jose</a>) 来看看我们使用的其他插件。 浏览 <a href="https://vimawesome.com/">Vim Awesome</a> 来了解一些很棒的插件。 这个话题也有很多博客文章： 搜索 “best Vim plugins”。</p>
<h1 id="其他程序的-vim-模式">其他程序的 Vim 模式</h1>
<p>很多工具提供了 Vim 模式。 这些 Vim 模式的质量参差不齐； 取决于具体工具， 有的提供了 很多酷炫的 Vim 功能， 但是大多数对基本功能支持的很好。</p>
<h2 id="shell">Shell</h2>
<p>如果你是一个 Bash 用户， 用 <code>set -o vi</code>。 如果你用 Zsh： <code>bindkey -v</code>。 Fish 用 <code>fish_vi_key_bindings</code>。 另外， 不管利用什么 shell， 你可以 <code>export EDITOR=vim</code>。 这是一个用来决定当一个程序需要启动编辑时启动哪个的环境变量。 例如， <code>git</code> 会使用这个编辑器来编辑 commit 信息。</p>
<h2 id="readline">Readline</h2>
<p>很多程序使用 <a href="https://tiswww.case.edu/php/chet/readline/rltop.html">GNU Readline</a> 库来作为 它们的命令控制行界面。 Readline 也支持基本的 Vim 模式， 可以通过在 <code>~/.inputrc</code> 添加如下行开启：</p>
<pre><code>set editing-mode vi
</code></pre>
<p>比如， 在这个设置下， Python REPL 会支持 Vim 快捷键。</p>
<h2 id="其他">其他</h2>
<p>甚至有 Vim 的网页浏览快捷键 <a href="http://vim.wikia.com/wiki/Vim_key_bindings_for_web_browsers">browsers</a>, 受欢迎的有 用于 Google Chrome 的 <a href="https://chrome.google.com/webstore/detail/vimium/dbepggeogbaibhgnhhndojpepiihcmeb?hl=en">Vimium</a> 和用于 Firefox 的 <a href="https://github.com/tridactyl/tridactyl">Tridactyl</a>。 你甚至可以在 <a href="https://github.com/lambdalisue/jupyter-vim-binding">Jupyter notebooks</a> 中用 Vim 快捷键。</p>
<h1 id="vim-进阶">Vim 进阶</h1>
<p>这里我们提供了一些展示这个编辑器能力的例子。我们无法把所有的这样的事情都教给你， 但是你 可以在使用中学习。 一个好的对策是: 当你在使用你的编辑器的时候感觉 “一定有更好的方法来做这个”， 那么很可能真的有： 上网搜寻一下。</p>
<h2 id="搜索和替换">搜索和替换</h2>
<p><code>:s</code> （替换） 命令 （<a href="http://vim.wikia.com/wiki/Search_and_replace">文档</a>）。</p>
<ul>
<li>
<pre><code class="language-plaintext">  %s/foo/bar/g
</code></pre>
<ul>
<li>在整个文件中将 foo 全局替换成 bar</li>
</ul>
</li>
<li>
<pre><code class="language-plaintext">  %s/\[.*\](\(.*\))/\1/g
</code></pre>
<ul>
<li>将有命名的 Markdown 链接替换成简单 URLs</li>
</ul>
</li>
</ul>
<h2 id="多窗口">多窗口</h2>
<ul>
<li>用 <code>:sp</code> / <code>:vsp</code> 来分割窗口</li>
<li>同一个缓存可以在多个窗口中显示。</li>
</ul>
<h2 id="宏">宏</h2>
<ul>
<li>
<p><code>q{字符}</code> 来开始在寄存器 <code>{字符}</code> 中录制宏</p>
</li>
<li>
<p><code>q</code> 停止录制</p>
</li>
<li>
<p><code>@{字符}</code> 重放宏</p>
</li>
<li>
<p>宏的执行遇错误会停止</p>
</li>
<li>
<p><code>{计数}@{字符}</code> 执行一个宏 {计数} 次</p>
</li>
<li>
<p>宏可以递归</p>
<ul>
<li>首先用 <code>q{字符}q</code> 清除宏</li>
<li>录制该宏， 用 <code>@{字符}</code> 来递归调用该宏 （在录制完成之前不会有任何操作）</li>
</ul>
</li>
<li>
<p>例子： 将 xml 转成 json (</p>
<p>file</p>
<p>)</p>
<ul>
<li>
<p>一个有 “name” / “email” 键对象的数组</p>
</li>
<li>
<p>用一个 Python 程序？</p>
</li>
<li>
<p>用 sed / 正则表达式</p>
<ul>
<li><code>g/people/d</code></li>
<li><code>%s/&lt;person&gt;/{/g</code></li>
<li><code>%s/&lt;name&gt;\(.*\)&lt;\/name&gt;/&quot;name&quot;: &quot;\1&quot;,/g</code></li>
<li>…</li>
</ul>
</li>
<li>
<p>Vim 命令 / 宏</p>
<ul>
<li>
<p><code>Gdd</code>, <code>ggdd</code> 删除第一行和最后一行</p>
</li>
<li>
<p>格式化最后一个元素的宏 （寄存器</p>
<pre><code class="language-plaintext">e
</code></pre>
<p>）</p>
<ul>
<li>跳转到有 <code>&lt;name&gt;</code> 的行</li>
<li><code>qe^r&quot;f&gt;s&quot;: &quot;&lt;ESC&gt;f&lt;C&quot;&lt;ESC&gt;q</code></li>
</ul>
</li>
<li>
<p>格式化一个人的宏</p>
<ul>
<li>跳转到有 <code>&lt;person&gt;</code> 的行</li>
<li><code>qpS{&lt;ESC&gt;j@eA,&lt;ESC&gt;j@ejS},&lt;ESC&gt;q</code></li>
</ul>
</li>
<li>
<p>格式化一个人然后转到另外一个人的宏</p>
<ul>
<li>跳转到有 <code>&lt;person&gt;</code> 的行</li>
<li><code>qq@pjq</code></li>
</ul>
</li>
<li>
<p>执行宏到文件尾</p>
<ul>
<li><code>999@q</code></li>
</ul>
</li>
<li>
<p>手动移除最后的 <code>,</code> 然后加上 <code>[</code> 和 <code>]</code> 分隔符</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h1 id="扩展资料">扩展资料</h1>
<ul>
<li><code>vimtutor</code> 是一个 Vim 安装时自带的教程</li>
<li><a href="https://vim-adventures.com/">Vim Adventures</a> 是一个学习使用 Vim 的游戏</li>
<li><a href="http://vim.wikia.com/wiki/Vim_Tips_Wiki">Vim Tips Wiki</a></li>
<li><a href="https://vimways.org/2019/">Vim Advent Calendar</a> 有很多 Vim 小技巧</li>
<li><a href="http://www.vimgolf.com/">Vim Golf</a> 是用 Vim 的用户界面作为程序语言的 <a href="https://en.wikipedia.org/wiki/Code_golf">code golf</a></li>
<li><a href="https://vi.stackexchange.com/">Vi/Vim Stack Exchange</a></li>
<li><a href="http://vimcasts.org/">Vim Screencasts</a></li>
<li><a href="https://pragprog.com/book/dnvim2/practical-vim-second-edition">Practical Vim</a> （书）</li>
</ul>
<h1 id="课后练习">课后练习</h1>
<ol>
<li>
<p>完成 <code>vimtutor</code>。 备注： 它在一个<br>
<a href="https://en.wikipedia.org/wiki/VT100">80x24</a> （80 列， 24 行）<br>
终端窗口看起来最好。✔️</p>
</li>
<li>
<p>下载我们的 <a href="/2020/files/vimrc">基本 vimrc</a>， 然后把它保存到 <code>~/.vimrc</code>。 通读这个注释详细的文件<br>
（用 Vim!）， 然后观察 Vim 在这个新的设置下看起来和使用起来有哪些细微的区别。✔️</p>
</li>
<li>
<p>安装和配置一个插件：✔️<br>
<a href="https://github.com/ctrlpvim/ctrlp.vim">ctrlp.vim</a>.</p>
<ol>
<li>用 <code>mkdir -p ~/.vim/pack/vendor/start</code> 创建插件文件夹</li>
<li>下载这个插件： <code>cd ~/.vim/pack/vendor/start; git clone https://github.com/ctrlpvim/ctrlp.vim</code></li>
<li>读这个插件的<br>
<a href="https://github.com/ctrlpvim/ctrlp.vim/blob/master/readme.md">文档</a>。<br>
尝试用 CtrlP 来在一个工程文件夹里定位一个文件， 打开 Vim, 然后用 Vim 命令控制行开始<br>
<code>:CtrlP</code>.</li>
<li>自定义 CtrlP： 添加<br>
<a href="https://github.com/ctrlpvim/ctrlp.vim/blob/master/readme.md#basic-options">configuration</a><br>
到你的 <code>~/.vimrc</code> 来用按 Ctrl-P 打开 CtrlP</li>
</ol>
</li>
<li>
<p>练习使用 Vim, 在你自己的机器上重做 <a href="#demo">演示</a>。✔️</p>
<ul>
<li>main is never called
<ul>
<li><code>G</code> end of file</li>
<li><code>o</code> open new line below</li>
<li>type in &quot;if <strong>name</strong> ...&quot; thing</li>
</ul>
</li>
<li>starts at 0 instead of 1
<ul>
<li>search for <code>/range</code></li>
<li><code>ww</code> to move forward 2 words</li>
<li><code>i</code> to insert text, &quot;1, &quot;</li>
<li><code>ea</code> to insert after limit, &quot;+1&quot;</li>
</ul>
</li>
<li>newline for &quot;fizzbuzz&quot;
<ul>
<li><code>jj$i</code> to insert text at end of line</li>
<li>add &quot;, end=''&quot;</li>
<li><code>jj.</code> to repeat for second print</li>
<li><code>jjo</code> to open line below if</li>
<li>add &quot;else: print()&quot;</li>
</ul>
</li>
<li>fizz fizz
<ul>
<li><code>ci'</code> to change fizz</li>
</ul>
</li>
<li>command-line argument
<ul>
<li><code>ggO</code> to open above</li>
<li>&quot;import sys&quot;</li>
<li><code>/10</code></li>
<li><code>ci(</code> to &quot;int(sys.argv[1])&quot;</li>
</ul>
</li>
</ul>
<pre><code class="language-python"># fizz_buzz.py
import sys

def fizz_buzz(limit):
    for i in range(1, limit+1):
        if i % 3 == 0:
            print('fizz', end='')
        if i % 5 == 0:
            print('buzz', end='')
        if i % 3 and i % 5:
            print(i)

def main():
    fizz_buzz(int(sys.argv[1]))

if __name__ == '__main__':
    main()
</code></pre>
</li>
<li>
<p>下个月用 Vim 做你 <em>所有</em> 文件编辑。 每当不够高效的时候, 或者你感觉 “一定有一个更好的方式”，<br>
尝试求助搜索引擎， 很有可能有一个更好的方式。 如果你遇到难题， 来我们的答疑时间或者给我们发邮件。✔️</p>
</li>
<li>
<p>在你的其他工具中设置 Vim 快捷键 （见上面的操作指南）。✔️</p>
</li>
<li>
<p>进一步自定义你的 <code>~/.vimrc</code> 和安装更多插件。✔️</p>
</li>
<li>
<p>（高阶） 用 Vim 宏将 XML 转换到 JSON (<a href="/2020/files/example-data.xml">例子文件</a>)。<br>
尝试着先完全自己做， 但是在你卡住的时候可以查看上面<br>
<a href="#macros">宏</a> 章节。✔️</p>
<ul>
<li>
<p>用 sed / 正则表达式</p>
<pre><code class="language-shell">cat example-data.xml | sed  '/people/d' | sed 's/&lt;person&gt;/{/g' | sed 's/&lt;\/person&gt;/},/g' | sed 's/&lt;name&gt;\(.*\)&lt;\/name&gt;/&quot;name&quot;: &quot;\1&quot;,/g' | sed 's/&lt;email&gt;\(.*\)&lt;\/email&gt;/&quot;email&quot;: &quot;\1&quot;/g' &gt;data_changed.json
# 手动移除最后的 , 然后加上 [ 和 ] 分隔符
</code></pre>
</li>
<li>
<p>Vim 命令 / 宏</p>
<ul>
<li><code>Gdd</code>, <code>ggdd</code> 删除第一行和最后一行</li>
<li>格式化name的宏 （寄存器e）
<ul>
<li>跳转到有 <code>&lt;name&gt;</code> 的行</li>
<li><code>qe^r&quot;f&gt;s&quot;: &quot;&lt;ESC&gt;f&lt;C&quot;&lt;ESC&gt;q</code></li>
</ul>
</li>
<li>格式化person的宏
<ul>
<li>跳转到有 <code>&lt;person&gt;</code> 的行</li>
<li><code>qpS{&lt;ESC&gt;j@eA,&lt;ESC&gt;j@ejS},&lt;ESC&gt;q</code></li>
</ul>
</li>
<li>格式化一个人然后转到另外一个人的宏
<ul>
<li>跳转到有 <code>&lt;person&gt;</code> 的行</li>
<li><code>qq@pjq</code></li>
</ul>
</li>
<li>执行宏到文件尾
<ul>
<li><code>999@q</code></li>
</ul>
</li>
<li>手动移除最后的 <code>,</code> 然后加上 <code>[</code> 和 <code>]</code> 分隔符</li>
</ul>
</li>
</ul>
</li>
</ol>

                </div>
            </article>
        </div>

        
            <div class="next-post">
                <div class="next gt-c-content-color-first">下一篇</div>
                <a href="https://umeimmense.github.io/post/shell-gong-ju-he-jiao-ben" class="post-title gt-a-link">
                    Shell 工具和脚本
                </a>
            </div>
        

        

        

        

        <div class="site-footer gt-c-content-color-first">
    <div class="slogan gt-c-content-color-first"></div>
    <div class="social-container">
        
            
                <a href="https://github.com/umeimmense" target="_blank">
                    <i class="fab fa-github gt-c-content-color-first"></i>
                </a>
            
        
            
        
            
        
            
        
            
        
            
        
    </div>
    <div class="footer-info">
        
    </div>
    <!-- <div>
        Theme by <a href="https://imhanjie.com/" target="_blank">imhanjie</a>, Powered by <a
                href="https://github.com/getgridea/gridea" target="_blank">Gridea | <a href="https://umeimmense.github.io/atom.xml" target="_blank">RSS</a></a>
    </div> -->
</div>

<script>
  hljs.initHighlightingOnLoad()
</script>

    </div>
</div>
</body>
</html>
